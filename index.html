<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Jamesy Creator</title>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="icon" href="shapes.png">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">

<link rel="manifest" href="manifest.json">

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&family=Roboto:ital,wght@0,100..900;1,100..900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    
  <style>
    * {
      box-sizing: border-box;
      font-family: "Mulish";
      margin: 0;
      padding: 0;
    }

    body {
      background-color: #eaf0fb;
      min-height: 100vh;
    }

      .body {
            display: flex;
          }

    aside {
      width: 220px;
      background-color: #eaf0fb;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      position: relative;
      height: 100vh;
      gap: 1rem;
      transition: transform 0.3s ease-in-out;
    }

    aside button {
      background: none;
      border: none;
      padding: 12px 16px;
      text-align: left;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
        font-family:"Rubik";
      align-items: center;
      gap: 10px;
      color: #1f1f1f;
    }

      
    aside button:hover {
    background: #dde7f5;
    }

    aside button .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      font-size: 20px;
    }

    aside button.active {
      background-color: #005cb2;
      color: white;
    }

    aside button.active .material-symbols-outlined {
      color: white;
    }

    main {
      flex-grow: 1;
      padding: 2rem;
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
    }

    .header {
      font-size: 28px;
      font-weight: bold;
    display:block;
     /*   margin-left:14px; */
      margin-bottom: 1.4rem;
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1.5rem;
    }

    .card {
      padding: 1.5rem;
      border-radius: 16px;
      font-size: 18px;
        cursor:pointer;
      font-weight: 500;
        text-decoration:none;
      color: #1f1f1f;
    }

      .card:hover {
       /* outline:solid #99c0ff 2px;  */
          text-decoration:underline;
      
          }

  /*  .blue { background: #dbe9ff; color: #1a73e8; }
    .red { background: #fdecec; color: #b00020; }
    .yellow { background: #fff5d7; color: #795300; }
    .green { background: #e0f3ea; color: #137333; } */

      .card.green { background: #daf5dc; color: #1a5e2e; }
.card.yellow { background: #fff3c7; color: #8a5800; }
.card.blue { background: #c9e1fc; color: #215a99; }
.card.red { background: #f9dada; color: #9e1c1c; }
      .card.aliceblue { background:aliceblue; color:black; }
      .card.teal {
  background: #d2f2f0;
  color: #00796b;
}
      .card.orange {
  background: #ffe6cc;
  color: #d35400;
}
.card.slate {
  background: #eceff1;
  color: #37474f;
}

.close-nav {
  display:none;
}

      .card.pink {
  background: #fce4ec;
  color: #c2185b;
}
      .card.gray {
  background: #f5f5f5;
  color: #616161;
}
      .card.purple {
  background: #e9ddfb;
  color: #5e35b1;
}
     

.footer {
  position: absolute;
  bottom: 90px;
  left: 1rem;
  right: 1rem;
  font-size: 13px;
  color: #444;
}
 
    .footer a {
      color: #444;
      text-decoration: none;
      margin-right: 8px;
    }

      .fill {
        
        width:100%;
          background:white;
          border-radius:15px;
          border:none;
          outline:none;
          height:100vh;

          }

      .logo { 
          width:40px;
          height:40px;
          }

      .title {
          display:inline-block;
          margin-left:10px;
          cursor:default;
         margin-top:10px;
          font-size:14px;
          }

      .logo-container {
            display:flex;
          }

      .home-scroll {
          background:transparent;
          padding-bottom:25vh;
          padding-left:3px;
          padding-right:3px;
          overflow-y:scroll;
          overflow-x:hidden;
          height:100vh;
          }


      .mobile-menu-btn {
        display: none;
        position: fixed;
        top: 0.25rem;
        left: 0.5rem;
        z-index: 1001;
      background:transparent;
        color: black;
        border: none;
        border-radius: 12px;
        padding: 8px;
        padding-left:10px;
        padding-right:10px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .mobile-menu-btn:hover {
       
        transform: scale(1.05);
      }

      .mobile-menu-btn .material-symbols-outlined {
        font-size: 24px;
        font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      }

      /* Mobile overlay */
      .mobile-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }

      .mobile-overlay.active {
        opacity: 1;
      }

     @media (max-width: 1000px) {
  .mobile-menu-btn {
    display: block;
  }

  .logo {
    margin-left:47px !important;
  }

  #searchContainer {
    width:50% !important;
  }

  .title {
    display:none;
  }

  .close-nav {
    display:block;
  }

  .mobile-overlay:not(.active) {
    display: none !important;
  }

  .mobile-overlay.active {
    display: block;
  }
  
        aside {
          position: fixed;
          top: 0;
          left: 0;
          z-index: 1000;
          transform: translateX(-100%);
          box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
        }

        aside.mobile-open {
          transform: translateX(0);
        }

        main {
          width: 100%;
          padding: 1rem;
          padding-top: 4rem;
        }

        .header {
          margin-left: 0;
        }
      }

   .cards .card:last-child:nth-child(odd):nth-child(n+3) {
  grid-column: span 2;
}

@media (max-width: 768px) {
  .cards .card:last-child {
    grid-column: 1 / -1;
  }
}

@media (max-width: 660px) {
    .a2383 {
    display:none;
  }
}


.description {
  font-size:16px;
  display:block;
  margin-left:15px;
  margin-bottom:15px;
  padding:0px;
}

.banner {
  width:100%;
  height:140px;
  background:url("nav_banner.png");
  background-size:cover;
  margin-bottom:30px;
  border-radius:15px;
}

      .top-nav {
        height:50px;
          background:white;
          padding-top:7px;
          margin-right:0px;
          padding-right:0px;
          display:flex;
          padding-right:25px;
          }

  </style>

     <style>
/*  #searchContainer {
    position: relative;
    width: 100%;
    margin-bottom: 20px;
  }

  #searchBar {
    width: 100%;
    font-size: 18px;
    height: 50px;
    padding: 10px 45px 10px 15px; 
    outline: none;
    border-radius: 5px;
    font-family: "Mulish";
    border: solid whitesmoke 1px;
    box-sizing: border-box;
    display: block;
  }

  #searchBtn {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    font-family: "Material Symbols Outlined";
    font-size: 28px;
    background: none;
    border: none;
    cursor: pointer;
    color: black;
    padding: 0;
    line-height: 1;
  } */

      #searchContainer {
    width: 30%;
    margin-left:auto;
  }

  #searchBar {
    width: 100%;
    font-size: 15px;
    height: 35px;
    padding: 4px;
      padding-left:12px;
    outline: none;
    border-radius: 3px;
    font-family: "Rubik";
    border: solid whitesmoke 2px;
    display: block;
  }

#searchBar:hover, #searchBar:focus {
    border:solid skyblue 2px;
    }
         
  #searchBtn {
  display:none;
  }

    .logo {
      height:35px;
        width:35px;
        margin-left:15px;
        }

         .title {
             font-size:17px;
             font-family:"Rubik";
             }
         
     .top-nav-items {
          display:flex;
      }

         .sign-in-items {
           margin-left:10px;
             font-family:"Rubik";
             }

         .sign-in-items button {
             height:80%;
             font-family:"Rubik";
             width:100px;
             font-size:14px;
             border-radius:3px;
             border:solid whitesmoke 0px;
             color:black;
             cursor:pointer;
             }

         .sign-in-items button:hover {
                border:solid rgb(255, 210, 215) 2px;
             }

      .rainbow-btn {
  background: linear-gradient(90deg,
    #ffe0f0 0%,
    #fff1cc 20%,
    #e6ffe0 40%,
    #d0e6ff 60%,
    #e6dfff 80%,
    #ffe0f0 100%);
  background-size: 300% 100%;
  animation: rainbow 3s linear infinite;
}

@keyframes rainbow {
  0%   { background-position: 0% 0%; }
  50%  { background-position: 100% 0%; }
  100% { background-position: 0% 0%; }
}


.light-btn {
  background:rgb(190, 255, 190);
}

.a2383 {
    margin-right:6px;
}

.a2383:hover {
    border-color:lightgreen !important;
}

</style>
    
</head>
<body>


    <div class="top-nav">
        <div class="top-nav-items">
            <img class="logo" src="shapes.png">
            <span class="title">Jamesy Creator</span>
            </div>
        <div id="searchContainer">
  <input id="searchBar" placeholder="Search Jamesy Creator or type a URL" autocomplete="off">
  <button id="searchBtn" aria-label="Search">arrow_forward</button>
</div>

        <div class="sign-in-items">
          <button class="light-btn a2383" id="downloadAsAppBtn" onclick="downloadAsApp()">Download</button>
            <button class="rainbow-btn" onclick="showPage('apps');">Create +</button>
                </div>
    </div>

    <div class="body">
  <button class="mobile-menu-btn" id="menu-button" onclick="toggleMobileNav()">
    <span class="material-symbols-outlined">menu</span>
  </button>


  <div class="mobile-overlay" onclick="closeMobileNav()"></div>

  <aside id="nav">
    <button onclick="showPage('home')" class="active">
      <span class="material-symbols-outlined">home</span>
      Home
    </button>
  <!--  <button onclick="showPage('apps')">
      <span class="material-symbols-outlined">apps</span>
      Apps & Tools
    </button> -->

      <button onclick="showPage('apps')">
      <span class="material-symbols-outlined">add_2</span>
      Create
    </button>

      <button onclick="showPage('apps2')">
      <span class="material-symbols-outlined">apps</span>
      My Apps
    </button>

    <button onclick="showPage('profile')">
           <span class="material-symbols-outlined">person</span>
      Profile
    </button>
      <button onclick="showPage('settings')">
      <span class="material-symbols-outlined">settings</span>
      Settings
    </button>

       <button onclick="showPage('feedback')">
      <span class="material-symbols-outlined">chat</span>
      Feedback
    </button>

          <button onclick="toggleMobileNav()" class="close-nav">
      <span class="material-symbols-outlined">arrow_back</span></button>
      
    <div class="footer">
        <div style="display:none;" class="logo-container">
      <img src="shapes.png" class="logo"> <span class="title">Jamesy Creator</span>
            </div>
    </div>
  </aside>

  <main>
    <div id="home" class="page active">

        <div class="home-scroll">

      

            <div class="banner"> </div>
            
      <div class="header">Welcome back, <span class="username"></span>!</div>
    <!-- <span class="description">Where should we start?</span> -->



<!-- <div id="searchContainer">
  <input id="searchBar" placeholder="Search for apps & tools...">
  <button id="searchBtn" aria-label="Search">arrow_forward</button>
</div> -->





          <div class="cards">
 <a href="open.html" class="card teal">Open file</a>
            </div>
        <br>

          <div class="cards">
 <a href="https://jamesy-tech.github.io/jamesy-creator-ideas" class="card pink">[NEW] Ideas</a>
            </div>
        <br>

   <div class="cards">
  <a href="https://jamesy-tech.github.io/jamesy-creator-docs" class="card green">Docs</a>
  <a href="https://jamesy-tech.github.io/jamesy-creator-drawings" class="card yellow">Drawings</a>
 <!-- <a href="https://jamesy-tech.github.io/text-editor" class="card blue">Code</a> -->
  <a href="https://jamesy-tech.github.io/jamesy-creator-notes" class="card orange">Notes</a>
</div>

      <!--     <div class="cards">
 <a href="view_md.html" class="card aliceblue">MD Viewer & Editor</a>
             
            </div>
<br>
          <div class="cards">
  <a href="files.html" class="card aliceblue">Local Storage & Files</a>
             
            </div> -->

            <br>

              <div class="cards">

            <a href="#" onclick="window.location.href = 'https://jamesy-tech.github.io/markdown-editor';" class="card aliceblue">Markdown Viewer & Editor</a>
  
            </div>
        

        <br>

            <div class="cards">

            <a href="#" onclick="showPage('profile'); " class="card aliceblue">Profile</a>
  
            </div>

        <br>
         <div class="cards">

            
            <a href="#" onclick="showPage('settings');" class="card aliceblue">Account & Settings</a>
  
            </div>

                <br>

                <div class="cards">

            <a href="#" onclick="showPage('apps'); " class="card aliceblue">All apps & tools...</a>
  
            </div>



            </div>
    </div>

    

    <div id="apps" class="page">
      
        <div class="header" style="display:none;" id="apps_header">Apps & tools</div> 
     <iframe src="grid.html" id="apps_iframe" class="fill"></iframe>

    </div>

     <div id="apps2" class="page">
      
        <div class="header" style="display:none;" id="apps_header">Apps & tools</div> 
     <iframe src="grid.html?hide=true" id="apps_iframe" class="fill"></iframe>

    </div>


        <div id="feedback" class="page">
      
        <div class="header" style="display:none;" id="apps_header">Feedback</div> 
     <iframe src="feedback.html" id="apps_iframe" class="fill"></iframe>

    </div>

    

        <div id="profile" class="page">
          <br>
<div class="header">Profile</div>
     <iframe src="profile.html?event=window" class="fill"></iframe>
    </div>

        <div id="settings" class="page">
          <br>
            <div class="header">Account & Settings</div>
     <iframe src="account.html?event=window" class="fill"></iframe>
    </div>

  </main>

     <div style="
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100vw;
  background: #fff;
  border-top: 2px solid whitesmoke;
  display: flex;
  align-items: center;
  padding: 16px 24px;
  gap: 16px;
  margin: 0;
" id="banner">
  <img 
    src="avatars/guest.png" 
    alt="Profile" 
    id="avatar"
    style="
      height: 48px;
      width: 48px;
      border-radius: 50%;
      object-fit: cover;
    "
  />
  <div style="display: flex; flex-direction: column; line-height: 1.2;">
    <span 
      id="usernameDisplay" class="username"
      style="
        font-size: 1.25rem;
        font-weight: 600;
        color: #333;
      "
    >
      Guest
    </span>
    <span style="font-size: 0.875rem; color: #666;">
      0 points
    </span>
  </div>
</div>

        </div>



  <script>

    let deferredPrompt;

    function setupInstall() {
      window.addEventListener('beforeinstallprompt', e => {
        e.preventDefault();
        deferredPrompt = e;
      });
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js').catch(()=>{});
      }
    }

    async function downloadAsApp() {
      if (!deferredPrompt) {
        window.location.href = "https://sites.google.com/view/jamesy-creator/download"
    //    alert('Your device does not meet the requirements to download.');
        return;
      }
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      deferredPrompt = null;
    }

    window.addEventListener('load', setupInstall);

     const username_fill = document.querySelectorAll(".username")
     username_fill.forEach(e => e.textContent = localStorage.getItem("username"));
      
    function showPage(id) {

       document.getElementById("apps_header").textContent = "Apps & Tools";

      document.getElementById("apps_iframe").src = "grid.html"

      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');

      document.querySelectorAll('aside button').forEach(btn => btn.classList.remove('active'));
      event.target.closest('button').classList.add('active');
      
      if (window.innerWidth <= 800) {
        closeMobileNav();
      }

      document.getElementById("searchBar").value = "";

      if (id == "home") {
       //   document.getElementById("searchBar").focus();
      }

      if (id == "apps") {
    //    document.getElementById("searchBar").focus();
      }

    }



    const urlParams = new URLSearchParams(window.location.search);
const page = urlParams.get('page');

if (page) {
  showPage(page);
}

const searchBar = document.getElementById("searchBar");
  const searchBtn = document.getElementById("searchBtn");

function goToSearch() {

  const query = searchBar.value.trim();
  const isLikelyLink = /\b(?:[a-z0-9-]+\.)+[a-z]{2,}(?:\/[^\s]*)?\b/i.test(query);

  if (isLikelyLink) {
    window.location.href = `https://${query}`;
  } else {
    setTimeout(() => {

      document.getElementById("apps_iframe").src = `grid.html?query=${encodeURIComponent(query)}`;
      document.getElementById("apps_header").textContent = "Search";
      
       searchBar.blur();

    }, 10);

    showPage("apps");

 //  document.getElementById("searchBar").blur();

  }
}

const pageParams = new URLSearchParams(window.location.search);
const searchTerm = urlParams.get('query');

if (searchTerm) {
  const searchBar = document.getElementById('searchBar');
  if (searchBar) {
    searchBar.value = searchTerm;
    goToSearch();
  } else {
    //  searchBar.focus();
  }
} else {
   // searchBar.focus();
  // searchBar.focus();
}

searchBar.focus();

searchBar.addEventListener("keydown", e => {
  if (e.key === "Enter") {
    e.preventDefault();
 //  searchBar.value = ""
    goToSearch();
  }
});

  searchBtn.addEventListener("click", goToSearch);

function toggleMobileNav() {
 const nav = document.getElementById('nav');
 const overlay = document.querySelector('.mobile-overlay');
 const button = document.getElementById("menu-button")
 
 nav.classList.toggle('mobile-open');
 overlay.classList.toggle('active');
 button.style.display = button.style.display === 'none' ? 'block' : 'none';
}

    function closeMobileNav() {
      const nav = document.getElementById('nav');
      const overlay = document.querySelector('.mobile-overlay');
      
      nav.classList.remove('mobile-open');
      overlay.classList.remove('active');
      document.getElementById("menu-button").style.display = "block";
    }


    document.addEventListener('click', function(event) {
      const nav = document.getElementById('nav');
      const menuBtn = document.querySelector('.mobile-menu-btn');
      
      if (window.innerWidth <= 800 && 
          nav.classList.contains('mobile-open') && 
          !nav.contains(event.target) && 
          !menuBtn.contains(event.target)) {
        closeMobileNav();
      }
    });

    function updateAvatar() {
  const avatarImg = document.getElementById('avatar');
  const savedAvatar = localStorage.getItem('avatar');
  
  
  if (savedAvatar) {
    
    avatarImg.src = savedAvatar;
    
    avatarImg.onerror = function() {
      console.error('Failed to load avatar:', savedAvatar);
      console.log('Falling back to default avatar');
      avatarImg.src = 'avatars/guest.png';
    };
    
    avatarImg.onload = function() {

    };
  } else {
    console.log('No avatar stored, using default');
    avatarImg.src = 'avatars/guest.png';
  }
}

      updateAvatar();


 setInterval(updateAvatar, 10000);


 


function toggleSide() {

  console.log("toggleSide() fired")

  const sideNav = document.getElementById("nav");
  if (sideNav.style.display === "flex") {
    sideNav.style.display = "none";
  } else {
    sideNav.style.display = "flex";
  }
}





    function home() {
        window.location.reload()
        window.location.href = "index.html"
    }

 



const user = localStorage.getItem("username");

if (!user || user.toLowerCase() === "guest") {
  window.location.href = "login.html";
}

            document.addEventListener('keydown', function(event) {
    if (event.ctrlKey && event.key === 'q') {
        window.location.href = 'loginback.html?path=lock';
    }
});

if (localStorage.getItem('locked') === 'true') {
  window.location.href = 'loginback.html?path=lock';
}

if (!localStorage.getItem("userPassword")) {
    window.location.href = "login.html";
  }

      if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/service-worker.js")
      .then(() => console.log("Service Worker registered"))
      .catch(err => console.error("Service Worker registration failed:", err));
  }

  </script>
</body>
</html>
